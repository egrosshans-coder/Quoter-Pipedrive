# Quoter Webhook Field Analysis

## üìä **Overview**

This document analyzes the fields captured by Quoter's Zapier webhook when quotes are published. This analysis is crucial for understanding what data is available for Stage 3 implementation (quote number formatting and Pipedrive updates).

## üéØ **Webhook Source**

**Source**: Quoter ‚Üí Zapier webhook  
**Trigger**: Quote published event  
**Data Format**: Structured field mapping with "Data" prefix

## üìã **Complete Field Mapping**

### **üè∑Ô∏è Quote Core Data**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Id` | `7196454` | Integer | Quote ID in Quoter system |
| `Data Parent Quote Id` | - | String | Parent quote ID for revisions |
| `Data Revision` | `2` | Integer | Revision number |
| `Data Number` | `2` | Integer | Quote number (not our xxxxx-nn format) |
| `Data Internal Notes` | - | String | Internal notes |
| `Data Uuid` | `2778-182601d3-32d8-4c7a-9812-3766b85bccca` | String | Unique quote identifier |
| `Data Pdf Link` | `https://tlciscreative.quoter.com/quote/download/...` | URL | PDF download link |
| `Data Expiry Date` | `2025-09-09 07:00:00` | DateTime | Quote expiration |
| `Data Grace Period` | `0` | Integer | Grace period in days |
| `Data Recurring Time Period` | `1` | Integer | Recurring billing period |
| `Data Status` | `pending` | String | Quote status (draft, pending, published, etc.) |
| `Data Discount` | `total` | String | Discount type |
| `Data Total Upfront` | `1,000.00` | Decimal | Total upfront payment |
| `Data Total Recurring` | - | Decimal | Total recurring payment |
| `Data Upfront Payments` | `0` | Integer | Number of upfront payments |
| `Data Shipping` | `0.00` | Decimal | Shipping cost |
| `Data Taxes` | - | String | Tax information |
| `Data Tax 1` | - | String | First tax field |
| `Data Tax 2` | - | String | Second tax field |

### **üë§ Person/Contact Data**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Person Id` | `2559270` | Integer | **PIPEDRIVE PERSON ID** ‚≠ê |
| `Data Person Public Id` | `cont_316ubQWzpHB8Y97ZurW4oBQX9jx` | String | Quoter contact ID |
| `Data Person First Name` | `Robert` | String | Contact first name |
| `Data Person Last Name` | `Lee` | String | Contact last name |
| `Data Person Organization` | `Blue Owl Capital-2096` | String | **ORGANIZATION WITH EMBEDDED DEAL ID** ‚≠ê |
| `Data Person Title` | - | String | Job title |

### **üè† Address Information**

#### **Billing Address**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Person Addresses Billing Line 1` | `464 W 39th St` | String | Billing address line 1 |
| `Data Person Addresses Billing Line 2` | - | String | Billing address line 2 |
| `Data Person Addresses Billing City` | `Los Angeles` | String | Billing city |
| `Data Person Addresses Billing State Code` | `CA` | String | Billing state code |
| `Data Person Addresses Billing State Name` | `California` | String | Billing state name |
| `Data Person Addresses Billing Country Code` | `US` | String | Billing country code |
| `Data Person Addresses Billing Country Name` | `United States` | String | Billing country name |
| `Data Person Addresses Billing Postal Code` | `90731` | String | Billing postal code |

#### **Shipping Address**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Person Addresses Shipping` | - | String | Shipping address details |

### **üìû Contact Information**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Person Telephone Numbers Work` | `212-970-6981` | String | Work phone |
| `Data Person Telephone Numbers Mobile` | - | String | Mobile phone |
| `Data Person Telephone Numbers Fax` | - | String | Fax number |
| `Data Person Email Address` | `robert.lee@blueowl.com` | String | Email address |
| `Data Person Website` | - | String | Website |

### **üë®‚Äçüíº Quote Owner**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Quote Owner Id` | `136185` | Integer | Quote owner ID |
| `Data Quote Owner First Name` | `Eric` | String | Owner first name |
| `Data Quote Owner Last Name` | `Grosshans` | String | Owner last name |
| `Data Quote Owner Full Name` | `Eric Grosshans` | String | Owner full name |
| `Data Quote Owner Email` | `eric@tlciscreative.com` | String | Owner email |

### **üí∞ Financial & Currency**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Reseller` | - | String | Reseller information |
| `Data Currency Code` | `USD` | String | String | Currency code |
| `Data Currency Name` | `United States Dollar` | String | Currency name |

### **üìã Form/Template**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Form Id` | `50826` | Integer | Form/template ID |
| `Data Form Slug` | `test` | String | Form slug |
| `Data Form Title` | `test-with deal` | String | Form title |
| `Data Custom Fields` | - | String | Custom field data |
| `Data Checkout Custom Fields` | - | String | Checkout custom fields |

### **üì¶ Line Items (Detailed)**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Data Line Items ID` | `41290386` | Integer | Line item ID |
| `Data Line Items Quantity` | `1` | Integer | Quantity |
| `Data Line Items Name` | `Balloon Drops` | String | Item name |
| `Data Line Items Sku` | `BAL-DROP-001` | String | SKU |
| `Data Line Items Pricing Structure` | `fixed_per_unit` | String | Pricing structure |
| `Data Line Items Recurring` | `false` | Boolean | Is recurring |
| `Data Line Items Recurring Time Period` | `1` | Integer | Recurring period |
| `Data Line Items Base Price` | `1,000.00` | Decimal | Base price |
| `Data Line Items Base Unit Price` | `1,000.00` | Decimal | Unit price |
| `Data Line Items Base Cost` | `500.00` | Decimal | Base cost |
| `Data Line Items Base Margin Dollars` | `500.00` | Decimal | Margin in dollars |
| `Data Line Items Base Margin Percent` | `50.00` | Decimal | Margin percentage |
| `Data Line Items Total Upfront` | `1,000.00` | Decimal | Total upfront |
| `Data Line Items Total Recurring` | `0` | Decimal | Total recurring |
| `Data Line Items Total Cost` | `500.00` | Decimal | Total cost |
| `Data Line Items Total Margin Dollars` | `500.00` | Decimal | Total margin dollars |
| `Data Line Items Total Margin Percent` | `50.00` | Decimal | Total margin percentage |
| `Data Line Items Discount` | `0.00` | Decimal | Discount amount |
| `Data Line Items Total Upfront After Discount` | `1,000.00` | Decimal | Final upfront total |
| `Data Line Items Supplier` | - | String | Supplier information |
| `Data Line Items Type` | `Drop` | String | Item type |
| `Data Line Items Is Optional` | `false` | Boolean | Is optional item |
| `Data Line Items Is Optional Selected` | `false` | Boolean | Is selected |
| `Data Line Items Options` | - | String | Item options |
| `Data Line Items Custom Fields` | - | String | Item custom fields |

### **‚è∞ System Fields**
| Field | Value | Type | Description |
|-------|-------|------|-------------|
| `Timestamp` | `1754857377` | Integer | Unix timestamp |
| `Module` | `Quotes` | String | Module name |
| `Is New` | `1` | Integer | Is new record flag |
| `querystring` | - | String | Query parameters |

## üéØ **Critical Findings for Stage 3**

### **‚úÖ What We Have (Good News)**

1. **Pipedrive Person ID**: `Data Person Id: 2559270` - Perfect for mapping back to Pipedrive
2. **Organization with Deal ID**: `Blue Owl Capital-2096` - Deal ID `2096` is embedded
3. **Complete Financial Data**: Totals, margins, costs, discounts, taxes
4. **Full Address Information**: Billing and shipping addresses
5. **Line Item Details**: Comprehensive pricing and margin information
6. **Quote Metadata**: Status, revision, expiry, owner information

### **‚ùå What We're Missing (Challenges)**

1. **No Direct Pipedrive Deal ID**: The webhook doesn't capture `pipedrive_deal_id` directly
2. **No Custom Field Mapping**: We can't see Pipedrive custom fields in the webhook
3. **Deal ID Extraction Required**: We need to parse `Blue Owl Capital-2096` to extract `2096`

### **üîÑ Data Flow Analysis**

```
Quoter Quote Published ‚Üí Webhook ‚Üí Our System
     ‚Üì
Available Fields:
‚îú‚îÄ‚îÄ Pipedrive Person ID (2559270) ‚úÖ
‚îú‚îÄ‚îÄ Organization Name (Blue Owl Capital-2096) ‚úÖ
‚îú‚îÄ‚îÄ Financial Data (totals, margins, costs) ‚úÖ
‚îú‚îÄ‚îÄ Address Information ‚úÖ
‚îú‚îÄ‚îÄ Line Items ‚úÖ
‚îî‚îÄ‚îÄ Quote Metadata ‚úÖ

Missing Fields:
‚îú‚îÄ‚îÄ Direct Pipedrive Deal ID ‚ùå
‚îú‚îÄ‚îÄ Pipedrive Custom Fields ‚ùå
‚îî‚îÄ‚îÄ Direct Deal Reference ‚ùå
```

## üöÄ **Stage 3 Implementation Strategy**

### **Phase 1: Deal ID Extraction**
- Parse organization name `Blue Owl Capital-2096` to extract deal ID `2096`
- Use regex pattern: `.*-(\d+)$` to capture the deal ID suffix
- Fallback: Use Pipedrive Person ID to look up associated deals

### **Phase 2: Quote Number Formatting**
- Apply xxxxx-nn format: `02096-01` (deal 2096, quote 01)
- Use extracted deal ID from organization name
- Implement sequential numbering logic

### **Phase 3: Pipedrive Updates**
- Update deal with quote information using extracted deal ID
- Sync financial data, status, and quote details
- Use Pipedrive Person ID for contact verification

## üìù **Next Steps**

1. **Implement Deal ID extraction** from organization name
2. **Test quote number formatting** with xxxxx-nn pattern
3. **Build Pipedrive update functions** using available data
4. **Handle edge cases** where deal ID extraction fails

## ÔøΩÔøΩ **Questions for Further Investigation**

1. **Is the organization name format consistent?** (Always ends with `-{deal_id}`?)
2. **Can we access Pipedrive custom fields** through the API after getting the person ID?
3. **Are there other webhook events** that might provide deal information?
4. **Can we configure Quoter** to include additional fields in webhooks?

---

**Last Updated**: August 14, 2025  
**Source**: Quoter ‚Üí Zapier webhook analysis  
**Status**: Ready for Stage 3 implementation planning
